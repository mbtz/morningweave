# MorningWeave CLI (Go)

MorningWeave is a single-user CLI that builds a scheduled content digest from official platform APIs.
The Go CLI is the source of truth. Legacy Python packaging has been removed; use git history if needed.

## Quick start
- Install to PATH: `./scripts/install.sh` (or `go install ./cmd/morningweave`)
- Help: `morningweave --help`
- Init config and USER_TODO: `morningweave init`

## Requirements
- Go 1.24+ (module-managed; toolchain auto-download is enabled)
- macOS (primary), but intended to run on a home server as well

## Configuration overview
- `config.yaml` is created by `init` (defaults are safe and editable).
- `USER_TODO.md` is created by `init` and lists provider/platform setup steps.
- Secrets should be stored in the OS keychain or 1Password (plaintext is a fallback).
- Plaintext fallback lives under `secrets.values` and can be referenced via `secrets:<key>` or `env:VAR_NAME`.
- Platforms can define `weight` and per-source `source_weights` to influence ranking.

## Config examples
Example platform snippets to drop into `config.yaml`:

Reddit:
```yaml
platforms:
  reddit:
    enabled: true
    credentials_ref: "keychain:reddit"
    sources:
      subreddits: ["golang", "machinelearning"]
      users: ["spez"]
      keywords: ["golang", "llm"]
    source_weights:
      subreddits:
        golang: 1.2
```

X (x.com):
```yaml
platforms:
  x:
    enabled: true
    credentials_ref: "keychain:x"
    sources:
      users: ["OpenAI"]
      lists: ["1234567890"]
      keywords: ["golang", "machine learning"]
```

Instagram:
```yaml
platforms:
  instagram:
    enabled: true
    credentials_ref: "keychain:instagram"
    sources:
      accounts: ["openai"]
      hashtags: ["ai", "golang"]
```
Note: Instagram Graph API requires a Business or Creator account linked to a Facebook Page/app.

Hacker News:
```yaml
platforms:
  hn:
    enabled: true
    sources:
      lists: ["top", "best", "new"]
      keywords: ["golang", "llm"]
```

## Implemented commands
The following commands are implemented today:

- `init` - generate `config.yaml` and `USER_TODO.md`
- `add-platform <name>` - enable a platform and capture sources/creds ref
- `set-tags` - add/update tag definitions in `config.yaml`
- `set-category` - add/update category definitions in `config.yaml`
- `run [--tag <tag>|--category <cat>]` - execute a one-shot digest run
- `start --headless` / `stop` - run the background scheduler loop and stop it
- `cron` - emit crontab entries for the configured schedules
- `status` - show enabled platforms and next scheduled runs (last run recorded if available)
- `logs [--since <time>]` - show recent run history
- `test-email` - send a sample digest to verify email delivery
- `auth set|get|clear <platform|email>` - manage secret references without printing values

Examples:

```sh
morningweave init --email-provider resend
morningweave add-platform reddit
morningweave set-tags --name "ai" --keyword "llm" --keyword "machine learning" --language en
morningweave set-category --name "work" --keyword "golang" --recipient "you@example.com"
```

## Project docs
- `PRD.md` is the product specification.
- `USER_TODO.md` is generated by `init` and should be kept updated as you configure providers.

## Development
- Run tests: `go test ./...`
